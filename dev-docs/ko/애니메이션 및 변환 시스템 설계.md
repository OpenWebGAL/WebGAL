## 애니메이션 시스템 설계

WebGAL의 새 버전에서 `애니메이션`은 `PIXI.Ticker` 콜백 함수가 될 것입니다. 반면 `변형`은 특별한 애니메이션으로, 실행 시간이 0ms (애니메이션의 첫 프레임에서 스테이지 객체를 최종 상태로 설정)입니다.

게다가, 모든 스테이지 상태가 애니메이션 관련 퍼포먼스를 포함하지 않기 때문에 애니메이션이 끝난 후에도 스테이지 객체가 애니메이션 종료 후 설정된 위치(또는 적용된 효과)를 유지하도록 "내부 변형"이 필요합니다.

"내부 변형"은 지정된 key의 스테이지 객체에 적용할 효과의 연속된 기록입니다. "내부 변형"은 일반적으로 스테이지 객체의 애니메이션이 끝난 후 또는 스테이지 객체가 변경될 때 호출됩니다.

"내부 변형"이 스테이지 객체의 애니메이션 정상 작동에 영향을 주지 않도록 하기 위해, WebGAL 스테이지 컨트롤러는 애니메이션 중인 스테이지 객체의 key를 기록할 수 있습니다. 이러한 key는 잠금되어 변형을 적용할 수 없습니다. 애니메이션이 끝날 때까지 잠금이 해제되지 않습니다.

모든 애니메이션이 끝난 후, 애니메이션 실행 프로그램은 작동하는 스테이지 객체의 "최종 상태"를 해당 key의 스테이지 객체의 "내부 변형" 기록으로 업데이트합니다.

## 다른 유형의 애니메이션

WebGAL에서 스테이지 객체에 적용할 수 있는 애니메이션은 즉시 애니메이션과 종료 애니메이션으로 나눌 수 있습니다.

즉시 애니메이션은 스크립트가 호출되는 즉시 트리거됩니다. 애니메이션이 설정되지 않은 경우 스테이지 객체는 페이드인이라는 기본값을 가지므로, 사용자 정의 페이드인 애니메이션을 원한다면 캐릭터/배경을 바꾼 후 즉시 사용자 정의 애니메이션을 실행하면 됩니다.

반면에 종료 애니메이션은 캐릭터/배경이 제거될 때 적용됩니다. 기본적으로 페이드아웃이 적용되는데, 종료 애니메이션을 적용하려면 `-off` 접미사를 가진 종료 스테이지 객체에 즉시 애니메이션을 설정하는 것이 좋습니다.

따라서, 입장이나 퇴장 애니메이션은 setFigure 또는 setBg가 호출된 후에 적용해야 합니다. 이 명령어가 캐릭터를 추가하거나 삭제하기 위해 사용되는 경우에도 마찬가지입니다.
